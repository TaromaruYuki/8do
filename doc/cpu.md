# CPU

CPU Specification

- 8-bit
- 5 Registers
	- A: General Purpose
	- B: General Purpose
	- C: General Purpose
	- D: General Purpose
	- O: Offset / General Purpose
- 18-bit address bus
- 8-bit data bus
- 10-bit Stack Pointer

### Table of Contents

- [Registers](#registers)
- [Instructions](#instructions)
- [Addressing Modes](#addressing-modes)

## Registers

### A, B, C, D: General purpose

General purpose registers.

### O: Offset

Used for relative addressing.

## Instructions

### LDR

Load a value into a register.

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Immediate           | 0x2B       | 3         | 2          |
+---------------------+------------+-----------+------------+
| Absolute            | 0x23       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x34       | 2         | 1          |
+---------------------+------------+-----------+------------+
| Pointer             | 0x52       | 4         | 7          |
+---------------------+------------+-----------+------------+

### STR

Store a register value into memory.

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x3A       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Pointer             | 0x49       | 4         | 7          |
+---------------------+------------+-----------+------------+

### ADD

+-------+---------------+---------------------------+
| **Z** | Zero Flag     | Set if the result was 0   |
+-------+---------------+---------------------------+
| **N** | Negative Flag | Set if bit 7 is set       |
+-------+---------------+---------------------------+
| **C** | Carry Flag    | Set if bit 7 overflows    |
+-------+---------------+---------------------------+
| **O** | Overflow Flag | Set if bit 7 is incorrect |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Immediate           | 0x12       | 3         | 2          |
+---------------------+------------+-----------+------------+
| Absolute            | 0x0A       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x1B       | 2         | 1          |
+---------------------+------------+-----------+------------+

### SUB

+-------+---------------+---------------------------+
| **Z** | Zero Flag     | Set if the result was 0   |
+-------+---------------+---------------------------+
| **N** | Negative Flag | Set if bit 7 is set       |
+-------+---------------+---------------------------+
| **C** | Carry Flag    | Set if bit 7 overflows    |
+-------+---------------+---------------------------+
| **O** | Overflow Flag | Set if bit 7 is incorrect |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Immediate           | 0x33       | 3         | 2          |
+---------------------+------------+-----------+------------+
| Absolute            | 0x4B       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x3C       | 2         | 1          |
+---------------------+------------+-----------+------------+

### JMP

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xE7       | 4         | 3          |
+---------------------+------------+-----------+------------+
| Pointer             | 0x5A       | 4         | 7          |
+---------------------+------------+-----------+------------+

### BIZ

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB0       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNZ

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB1       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BIN

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB2       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNN

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB3       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BIC

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB4       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNC

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB5       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BIO

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB6       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNO

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB7       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BIL

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB8       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNL

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xB9       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BIG

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xBA       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNG

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xBB       | 4         | 3          |
+---------------------+------------+-----------+------------+

### SBL

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x22       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x01       | 2         | 1          |
+---------------------+------------+-----------+------------+

### SBR

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x28       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x39       | 2         | 1          |
+---------------------+------------+-----------+------------+

### ROL

+-------+---------------+---------------------------+
| **Z** | Zero Flag     | Set if the result was 0   |
+-------+---------------+---------------------------+
| **N** | Negative Flag | Set if bit 7 is set       |
+-------+---------------+---------------------------+
| **C** | Carry Flag    | Contents of old bit 7     |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x2e       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x3F       | 2         | 1          |
+---------------------+------------+-----------+------------+

### ROR

+-------+---------------+---------------------------+
| **Z** | Zero Flag     | Set if the result was 0   |
+-------+---------------+---------------------------+
| **N** | Negative Flag | Set if bit 7 is set       |
+-------+---------------+---------------------------+
| **C** | Carry Flag    | Contents of old bit 0     |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x54       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x45       | 2         | 1          |
+---------------------+------------+-----------+------------+

### CLC

+-------+---------------+---------------------------+
| **C** | Carry Flag    | Cleared                   |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Implied             | 0xD2       | 2         | 1          |
+---------------------+------------+-----------+------------+

### INC

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x3B       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x2C       | 2         | 1          |
+---------------------+------------+-----------+------------+

### DEC

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x0D       | 4         | 5          |
+---------------------+------------+-----------+------------+
| Register            | 0x1E       | 2         | 1          |
+---------------------+------------+-----------+------------+

### HLT

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Implied             | 0xE8       | 2         | inf        |
+---------------------+------------+-----------+------------+

### CMP

+-------+---------------+---------------------------+
| **Z** | Zero Flag     | Set if the result was 0   |
+-------+---------------+---------------------------+
| **N** | Negative Flag | Set if bit 7 is set       |
+-------+---------------+---------------------------+
| **G** | Greater Flag  | Set if A > B              |
+-------+---------------+---------------------------+
| **L** | Less Flag     | Set if A < B              |
+-------+---------------+---------------------------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Immediate           | 0x29       | 3         | 2          |
+---------------------+------------+-----------+------------+
| Absolute            | 0x21       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x32       | 2         | 1          |
+---------------------+------------+-----------+------------+

### PSH

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Immediate           | 0x74       | 3         | 2          |
+---------------------+------------+-----------+------------+
| Absolute            | 0x4C       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x3D       | 2         | 1          |
+---------------------+------------+-----------+------------+

### POP

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0x30       | 4         | 4          |
+---------------------+------------+-----------+------------+
| Register            | 0x41       | 2         | 1          |
+---------------------+------------+-----------+------------+

### JSR

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xEF       | 4         | 4          |
+---------------------+------------+-----------+------------+

### RTS

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Implied             | 0xEB       | 2         | 3          |
+---------------------+------------+-----------+------------+

### BII

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xD4       | 4         | 3          |
+---------------------+------------+-----------+------------+

### BNI

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Absolute            | 0xD9       | 4         | 3          |
+---------------------+------------+-----------+------------+

### CLI

+-------+------------------------+---------+
| **I** | Interrupt Disable Flag | Cleared |
+-------+------------------------+---------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Implied             | 0xD8       | 2         | 1          |
+---------------------+------------+-----------+------------+

### SEI

+-------+------------------------+---------+
| **I** | Interrupt Disable Flag | Set     |
+-------+------------------------+---------+

+---------------------+------------+-----------+------------+
| **Addressing Mode** | **Opcode** | **Bytes** | **Cycles** |
+---------------------+------------+-----------+------------+
| Implied             | 0xE1       | 2         | 1          |
+---------------------+------------+-----------+------------+


## Addressing Modes

<!-- TODO: Write documentation for Addressing Modes -->

## Interrupts

Interrupts work closer to the 8086 than the 6502. There is a interrupt acknowledge pin just like the 8086.
This pin is a output pin, so it should not be changed by the emulator but the CPU itself.

To request a interrupt, pull the `IRQ` pin low.
Once the CPU needs the IRQ value, you can send the IRQ value on the data pins. Use the first 4 pins, as the
interrupt number is only 4 bits (Max 0xF).

Some interrupt numbers are used by the CPU. The table below lists all reserved and free values.

+---------+-----------+-----------------+
| **ID**  | **Usage** | **Description** |
+---------+-----------+-----------------+
| 0x0     | Reset     | Resets the CPU  |
+---------+-----------+-----------------+
| 0x1     | NMI       | Non-maskable IR |
+---------+-----------+-----------------+
| 0x2-0xF | Unused    | Free to use     |
+---------+-----------+-----------------+

<!--
Interrupt Push  Interrupt Return
---             ---
Upper PC        Flags
Lower PC        Extended PC
Extended PC     Lower PC
Flags           Upper PC
-->